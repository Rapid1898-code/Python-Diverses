from openpyxl import load_workbook
from openpyxl.utils import get_column_letter
from openpyxl.styles import NamedStyle, Font, PatternFill, Border, Side
import pandas as pd

name_xlsx = "s-p_500-index__Stock_Data.xlsx"
wb =  load_workbook(name_xlsx)
#writer = pd.ExcelWriter (wb, engine='openpyxl', options={'strings_to_numbers': True})
#pd.DataFrame (name_xlsx).to_excel (writer, sheet_name=sh_price.title.upper(), header=False, index=False)
wb._sheets.sort(key=lambda x: x.title)

while True:
    try:
        wb.save (name_xlsx)
        wb.close ()
        break
    except Exception as e:
        print ("Error: ", e)
        input ("Datei kann nicht geöffnet werden - bitte schließen und <Enter> drücken!")

